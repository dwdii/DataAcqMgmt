---
title: 'Profiling a Data Set: Bike Sharing Demand'
author: "Daniel Dittenhafer"
date: "Tuesday, September 23, 2014"
output: pdf_document
---
----------------------------------------------------------------------------------------------------
Data Set         Number of              Attribute                        Number of 
Characteristics  Observations Area      Characteristics                  Attributes  Missing Values?
--------------- ------------- --------- -------------------------------- ----------- ---------------
Multivariate    10,886        Business  Categorical, Integer, Date/time  12          No     
--------------------------------------- -------------------------------- ----------- ---------------

#### Source ####

[Kaggle.com Competition: Bike Sharing Demand](https://www.kaggle.com/c/bike-sharing-demand)


#### Attribute Information ####

--------------------------------------------------------------------
Field      Data Type     Description
---------  ------------- --------------------------------------------
datetime   date & hour   Min: 01/01/2011 00:00;    
                         Max: 12/19/2012 23:00

season     integer       Categorical;
                         1 = spring;
                         2 = summer;
                         3 = fall;
                         4 = winter;
                         
holiday    boolean       1 = a holiday;
                         0 = not a holiday;

workingday boolean       1 = a work day;
                         0 = weekend or holiday;
                         
weather    integer       Categorical;
                         1: Clear, Few clouds, Partly cloudy, Partly cloudy;
                         2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist; 
                         3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds;
                         4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog; 
                         
temp       decimal       temperature in Celsius

atemp      decimal       temperature in Celsius that one might perceive

humidity   integer       relative humidity percentage

windspeed  decimal       the speed that air is moving in unknown units

casual     integer       the number of non-registered bike rentals for the hour

registered integer       the number of registered bike rentals for the hour

count      integer       the total number of rentals for the hour
--------------------------------------------------------------------

#### Comments ####

There were no inherent character columns and the data, 
where appropriate, was already converted to factor-like integer values. As such, in order to better map the data 
set to this exercise, I am adding a `seasonName` column and reverting the `season` column into this new column to begin with.
```{r}
# The path to the local dataset file
csv_file <- "C:/SourceCode/R/DataAcqMgmt/Week5/BikeSharingDemand.csv"

# Load the data into a data.frame
csv <- read.table(csv_file, header=TRUE, sep=",")

# Revert some columns to character data.
bikes <- data.frame(csv, seasonName=NA)
bikes[bikes$season == 1,]$seasonName <- "spring"
bikes[bikes$season == 2,]$seasonName <- "summer"
bikes[bikes$season == 3,]$seasonName <- "fall"
bikes[bikes$season == 4,]$seasonName <- "winter"

# Summary
summary(bikes)
```

#### Correlation Analysis ####

Using the `cor()` R function as shown in the following code, an analysis of correlation between the numeric attributes was performed. 
```{r}

bikeCor <- cor(bikes[, c(12, 6:11)])
bikesCorMelt <- reshape2::melt(bikeCor, varnames=c("x", "y"), value.name="Correlation")
bikesCorMelt <- bikesCorMelt[order(bikesCorMelt$Correlation),]

```

```{r, echo=FALSE}
require(ggplot2)
g1 <- ggplot(data=bikesCorMelt, aes(x=x, y=y))
g1 <- g1 + geom_tile(aes(fill=Correlation))
g1 <- g1 + scale_fill_gradient2(low="red", mid="white", high="steelblue", 
                                guide=guide_colorbar(ticks=FALSE, barheight=10),
                                limits=c(-1,1))
g1 <- g1 + theme_minimal()
g1 <- g1 + labs(title="Heatmap of Data Point Correlation")
g1

```
```{r, echo=FALSE}
bikeCor
```

#### Entropy Analysis ####

Using Entropy and Information Gain functions developed earlier, an entropy analysis was performed. Raw entropy of the bike rentals per hour was calculated initially.

```{r}
source("C:/SourceCode/R/DataAcqMgmt/EntropyFunctions.R", chdir=TRUE)

# Raw Entropy
entropy(bikes$casual)
entropy(bikes$registered)
entropy(bikes$count)
```

```{r}
casualEnt <- decide(bikes[,c(2,3,4,5,6,7,8,9,10)], 9)

casEntMelt <- reshape2::melt(casualEnt$gains, value.name="info.gain")
casEntMelt <- cbind(casEntMelt, attribute=rownames(casEntMelt))
casEntMelt <- casEntMelt[order(-casEntMelt$info.gain),]
casEntMelt
```
```{r, echo=FALSE}
require(ggplot2)
g2 <- ggplot(data=casEntMelt, aes(x=factor(attribute), y=info.gain))
g2 <- g2 + geom_bar(stat="identity")
g2 <- g2 + theme_minimal()
g2 <- g2 + scale_x_discrete(labels=as.character(casEntMelt$attribute), limits=as.character(casEntMelt$attribute))
g2 <- g2 + labs(title="Information Gain - Casual Bike Rental by Partition", x="Paritioning Attribute", y="Information Gain")
g2

```

```{r}
regEnt <- decide(bikes[,c(2,3,4,5,6,7,8,9,11)], 9)

regEntMelt <- reshape2::melt(regEnt$gains, value.name="info.gain")
regEntMelt <- cbind(regEntMelt, attribute=rownames(regEntMelt))
regEntMelt <- regEntMelt[order(-regEntMelt$info.gain),]
regEntMelt
```
```{r, echo=FALSE}
require(ggplot2)
g3 <- ggplot(data=regEntMelt, aes(x=factor(attribute), y=info.gain))
g3 <- g3 + geom_bar(stat="identity")
g3 <- g3 + theme_minimal()
g3 <- g3 + scale_x_discrete(labels=as.character(regEntMelt$attribute), limits=as.character(regEntMelt$attribute))
g3 <- g3 + labs(title="Information Gain - Registered User Bike Rental by Partition", x="Paritioning Attribute", y="Information Gain")
g3

```

```{r}
countEnt <- decide(bikes[,c(2,3,4,5,6,7,8,9,12)], 9)

countEntMelt <- reshape2::melt(countEnt$gains, value.name="info.gain")
countEntMelt <- cbind(countEntMelt, attribute=rownames(countEntMelt))
countEntMelt <- countEntMelt[order(-countEntMelt$info.gain),]
countEntMelt
```
```{r, echo=FALSE}
require(ggplot2)
g3 <- ggplot(data=countEntMelt, aes(x=factor(attribute), y=info.gain))
g3 <- g3 + geom_bar(stat="identity")
g3 <- g3 + theme_minimal()
g3 <- g3 + scale_x_discrete(labels=as.character(countEntMelt$attribute), limits=as.character(countEntMelt$attribute))
g3 <- g3 + labs(title="Information Gain - Registered User Bike Rental by Partition", x="Paritioning Attribute", y="Information Gain")
g3

```

#### References ####

Fanaee-T, Hadi, and Gama, Joao, Event labeling combining ensemble detectors and background knowledge, Progress in Artificial Intelligence (2013): pp. 1-15, Springer Berlin Heidelberg.

Lander, Jared P. "Correlation and Covariance." R for Everyone: Advanced Analytics and Graphics. New York: Addison-Wesley, 2014. N. pag. Print.

